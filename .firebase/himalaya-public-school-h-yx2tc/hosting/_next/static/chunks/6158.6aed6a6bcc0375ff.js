"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6158],{19134:(e,t,r)=>{r.d(t,{e:()=>s});var a=r(34477);let s=(0,a.createServerReference)("401db5a6cd2799d23e68391e645e29759a1a93ef82",a.callServer,void 0,a.findSourceMapURL,"askSchoolAI")},30285:(e,t,r)=>{r.d(t,{$:()=>c,r:()=>i});var a=r(95155),s=r(12115),n=r(99708),l=r(74466),o=r(59434);let i=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:l,asChild:c=!1,...u}=e,d=c?n.DX:"button";return(0,a.jsx)(d,{className:(0,o.cn)(i({variant:s,size:l,className:r})),ref:t,...u})});c.displayName="Button"},55365:(e,t,r)=>{r.d(t,{Fc:()=>i,TN:()=>u,XL:()=>c});var a=r(95155),s=r(12115),n=r(74466),l=r(59434);let o=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),i=s.forwardRef((e,t)=>{let{className:r,variant:s,...n}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,l.cn)(o({variant:s}),r),...n})});i.displayName="Alert";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",r),...s})});c.displayName="AlertTitle";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",r),...s})});u.displayName="AlertDescription"},58332:(e,t,r)=>{r.d(t,{LanguageProvider:()=>l,o:()=>o});var a=r(95155),s=r(12115);let n=(0,s.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,s.useState)("en");return(0,a.jsx)(n.Provider,{value:{language:r,setLanguage:l},children:t})}function o(){let e=(0,s.useContext)(n);if(void 0===e)throw Error("useLanguage must be used within a LanguageProvider");return e}},62523:(e,t,r)=>{r.d(t,{p:()=>l});var a=r(95155),s=r(12115),n=r(59434);let l=s.forwardRef((e,t)=>{let{className:r,type:s,...l}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-base",r),ref:t,...l})});l.displayName="Input"},76158:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var a=r(95155),s=r(12115),n=r(35695),l=r(51362),o=r(30285),i=r(66695),c=r(62523),u=r(89829),d=r(77724),m=r(50172),f=r(69592),h=r(84111),g=r(67270),x=r(55365),p=r(19134),v=r(58332),b=r(90792),w=r(58497),y=r(34646);let j=["What is the school's mission?","Tell me about the extracurricular activities.","What are the office hours?","Write a Python function to calculate factorial.","Make a simple text adventure game in Python.","What are the core values of the school?"],N="11x11",k="#10x10",S="hps_abuseStrikeCount_main",A="hps_cooldownEndTime_main";function I(e){let t=[...e];for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}function T(){let[e,t]=(0,s.useState)(""),[r,T]=(0,s.useState)(null),[C,L]=(0,s.useState)(!1),[E,P]=(0,s.useState)(null),[_,R]=(0,s.useState)(!1),[D,q]=(0,s.useState)(!1),M=(0,n.useRouter)(),{setTheme:F}=(0,l.D)(),{language:z}=(0,v.o)(),$=(0,s.useRef)(null),[W,B]=(0,s.useState)([]),[X,H]=(0,s.useState)(0),[Y,G]=(0,s.useState)(null),[V,Z]=(0,s.useState)(null),J=(0,s.useRef)(null),O=null!==Y&&Date.now()<Y;(0,s.useEffect)(()=>{B(I([...j]));let e=localStorage.getItem(S),t=localStorage.getItem(A);if(e&&H(parseInt(e,10)),t){let e=parseInt(t,10);e>Date.now()?G(e):(localStorage.removeItem(S),localStorage.removeItem(A),H(0))}},[]),(0,s.useEffect)(()=>{localStorage.setItem(S,X.toString()),Y?localStorage.setItem(A,Y.toString()):localStorage.removeItem(A)},[X,Y]),(0,s.useEffect)(()=>{if(J.current&&clearInterval(J.current),O&&Y){let e=()=>{let e=Y-Date.now();e<=0?(G(null),Z(null),H(0),localStorage.removeItem(S),localStorage.removeItem(A),J.current&&clearInterval(J.current)):Z(function(e){if(e<=0)return"0s";let t=Math.ceil(e/1e3),r=Math.floor(t/60),a=t%60;return r>0?"".concat(r,"m ").concat(a,"s"):"".concat(a,"s")}(e))};e(),J.current=setInterval(e,1e3)}return()=>{J.current&&clearInterval(J.current)}},[O,Y]);let U=(0,s.useCallback)(()=>{$.current&&requestAnimationFrame(()=>{$.current&&($.current.scrollTop=$.current.scrollHeight)})},[]);(0,s.useEffect)(()=>{U()},[C,E,r,U]);let K=(0,s.useCallback)(async(e,t)=>{if(e.trim()&&!O){L(!0),P(null),T(null);try{let r=await (0,p.e)({question:e,unrestrictedMode:t,language:z});if(r.action&&("navigate"===r.action.type&&"string"==typeof r.action.payload?M.push(r.action.payload):"set_theme"===r.action.type&&"string"==typeof r.action.payload&&F(r.action.payload)),r.safetyBlocked){let e=X+1;H(e);let t=6e4;e>1&&(t=Math.min((1+(e-1)*5)*6e4,864e5));let a=Date.now()+t;G(a),T(r.answer||"Your query was blocked due to content policy. Interaction is temporarily disabled.")}else if(void 0!==r.answer&&null!==r.answer){let e=r.answer.trim(),t=/^<!--[\s\S]*?-->$/.test(e);""===e||t?(r.action||P("The AI provided an empty or non-displayable response. Please try rephrasing your question or ask something else."),T(null)):T(r.answer)}else r.action||(P("The AI didn't provide an answer. Please try rephrasing your question."),T(null))}catch(t){console.error("Error fetching school information:",t);let e="An error occurred while trying to get information. Please try again later.";t instanceof Error&&(t.message.includes("503")||t.message.toLowerCase().includes("overloaded"))&&(e="The AI model is currently busy. Please try again in a few moments."),P(e),T(null)}L(!1),R(!1)}},[X,z,M,F,O]),Q=async r=>{if(r.preventDefault(),O)return;let a=e.trim();if(a.toLowerCase()===N){M.push("/teacher-conduit"),t("");return}if(a.toLowerCase()===k){q(!0),t(""),T(null),P(null);return}K(a,D)},ee=e=>{O||(t(e),R(!0),B(I([...j])))};return(0,s.useEffect)(()=>{_&&e&&!C&&!O&&(e.trim().toLowerCase()===k?(q(!0),t(""),T(null),P(null),R(!1)):e.trim().toLowerCase()===N?(M.push("/teacher-conduit"),t(""),R(!1)):K(e,D))},[_,e,C,D,O,K,M]),(0,a.jsxs)(i.Zp,{className:"flex flex-col h-full w-full shadow-none border-0 bg-transparent backdrop-blur-xl",children:[(0,a.jsxs)(i.aR,{className:"border-b border-white/20",children:[(0,a.jsxs)(i.ZB,{className:"flex items-center gap-2 text-xl text-primary-foreground",children:[D?(0,a.jsx)(u.A,{className:"w-6 h-6 text-orange-300"}):(0,a.jsx)(d.A,{className:"w-6 h-6"}),D?"General AI Assistant":"HPS AI Assistant"]}),(0,a.jsx)(i.BT,{className:"text-primary-foreground/80",children:D?'You can ask me anything! To return to school-specific info, type "#10x10" again.':"Ask me anything about Himalaya Public School."})]}),(0,a.jsxs)(i.Wu,{ref:$,className:"flex-grow overflow-y-auto overflow-x-hidden p-6 space-y-4",children:[(0,a.jsxs)("form",{onSubmit:Q,className:"space-y-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)(c.p,{type:"text",value:e,onChange:e=>{t(e.target.value),_&&R(!1)},placeholder:D?"Ask a general knowledge question...":"Ask about the school...",className:"w-full bg-black/20 text-white placeholder:text-white/60 border-white/30 focus-visible:ring-offset-black/30 focus-visible:ring-accent",disabled:C||O,"aria-label":"Your question"})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 items-center",children:[(0,a.jsx)(o.$,{type:"submit",disabled:C||!e.trim()||O,className:"w-full sm:w-auto",children:C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.A,{className:"mr-2 h-4 w-4 animate-spin"}),_?"Asking...":"Thinking..."]}):"Ask AI"}),D&&!C&&!O&&(0,a.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>{q(!1),T(null),P(null),t("")},className:"w-full sm:w-auto text-orange-300 border-orange-400 hover:bg-orange-400/20 hover:text-orange-200",children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"Exit General Mode"]})]})]}),O&&V&&(0,a.jsxs)(x.Fc,{variant:"destructive",className:"mt-4 bg-yellow-500/20 border-yellow-400 text-yellow-100",children:[(0,a.jsx)(h.A,{className:"h-5 w-5 text-yellow-300"}),(0,a.jsx)(x.XL,{children:"Interaction Temporarily Disabled"}),(0,a.jsxs)(x.TN,{children:["Due to content policy, further interaction is paused. Please wait:",(0,a.jsx)("strong",{className:"ml-1 tabular-nums",children:V}),"."]})]}),!D&&!r&&!C&&!E&&!O&&W.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-white/70 mb-2 flex items-center",children:[(0,a.jsx)(g.A,{className:"w-4 h-4 mr-2"}),"Or try one of these:"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:W.map((e,t)=>(0,a.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>ee(e),disabled:C||O,className:"text-xs text-white/90 bg-white/5 border-white/20 hover:bg-white/10",children:e},t))})]}),(0,a.jsxs)("div",{id:"latest-answer-marker",children:[C&&(0,a.jsxs)("div",{className:"flex items-center justify-center text-white/70 mt-6",children:[(0,a.jsx)(m.A,{className:"mr-2 h-5 w-5 animate-spin"}),"The AI is thinking..."]}),E&&!C&&!O&&(0,a.jsxs)(x.Fc,{variant:"destructive",className:"mt-6 bg-red-500/20 border-red-400 text-red-200",children:[(0,a.jsx)(x.XL,{children:"Error"}),(0,a.jsx)(x.TN,{children:E})]}),null!==r&&!C&&!E&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-lg text-white mt-6",children:"AI's Response:"}),(0,a.jsx)("div",{className:"prose prose-sm md:prose-base max-w-none  prose-headings:text-white/90 prose-p:text-white/80  prose-strong:text-white prose-a:text-accent hover:prose-a:text-accent/80 prose-blockquote:text-white/70 prose-blockquote:border-accent prose-code:text-cyan-300 prose-code:before:content-[''] prose-code:after:content-[''] prose-code:font-mono prose-li:marker:text-white/80 ",children:(0,a.jsx)(b.oz,{children:r,components:{code(e){let{children:t,className:r,...s}=e,n=/language-(\w+)/.exec(r||"");return n?(0,a.jsx)(w.A,{...s,PreTag:"div",children:String(t).replace(/\n$/,""),language:n[1],style:y.xJ,wrapLines:!0,wrapLongLines:!0}):(0,a.jsx)("code",{...s,className:r,children:t})}}})})]})]})]})]})}}}]);