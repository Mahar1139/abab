"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3543],{3543:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var r=a(95155),s=a(12115),n=a(35695),l=a(51362),o=a(30285),c=a(62523),i=a(66424),d=a(38382),m=a(77724),u=a(91721),h=a(50172),f=a(84111);let y=(0,a(40157).A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var x=a(19134),p=a(59434),g=a(58332);let w="hps_abuseStrikeCount_float",b="hps_cooldownEndTime_float";function v(){let[e,t]=(0,s.useState)(!1),[a,v]=(0,s.useState)([]),[k,j]=(0,s.useState)(""),[N,S]=(0,s.useState)(!1),[A,I]=(0,s.useState)(!1),C=(0,s.useRef)(null),E=(0,n.useRouter)(),{setTheme:M}=(0,l.D)(),{language:T}=(0,g.o)(),[D,L]=(0,s.useState)(0),[_,R]=(0,s.useState)(null),[q,H]=(0,s.useState)(null),P=(0,s.useRef)(null),z=null!==_&&Date.now()<_,F="Hello! How can I help you with information about Himalaya Public School today?";(0,s.useEffect)(()=>{let e=localStorage.getItem(w),t=localStorage.getItem(b);if(e&&L(parseInt(e,10)),t){let e=parseInt(t,10);e>Date.now()?R(e):(localStorage.removeItem(w),localStorage.removeItem(b))}},[]),(0,s.useEffect)(()=>{localStorage.setItem(w,D.toString()),_?localStorage.setItem(b,_.toString()):localStorage.removeItem(b)},[D,_]),(0,s.useEffect)(()=>{if(P.current&&clearInterval(P.current),z&&_){let e=()=>{let e=_-Date.now();e<=0?(R(null),H(null),L(0),localStorage.removeItem(w),localStorage.removeItem(b),P.current&&clearInterval(P.current),v(e=>[...e,{id:"cooldown-over-".concat(Date.now()),text:"Your interaction cooldown has ended. You can ask questions again.",sender:"ai"}])):H(function(e){if(e<=0)return"0s";let t=Math.ceil(e/1e3),a=Math.floor(t/60),r=t%60;return a>0?"".concat(a,"m ").concat(r,"s"):"".concat(r,"s")}(e))};e(),P.current=setInterval(e,1e3)}return()=>{P.current&&clearInterval(P.current)}},[z,_]),(0,s.useEffect)(()=>{e&&0===a.length&&v([{id:"initial-greeting",text:F,sender:"ai"}])},[e,a.length,F]);let O=(0,s.useCallback)(()=>{C.current&&requestAnimationFrame(()=>{C.current&&(C.current.scrollTop=C.current.scrollHeight)})},[]);(0,s.useEffect)(()=>{O()},[a,O]);let Y=async e=>{null==e||e.preventDefault();let a=k.trim();if(!a||N||z)return;if("11x11"===a.toLowerCase()){E.push("/teacher-conduit"),j(""),t(!1);return}if("#10x10"===a.toLowerCase()){I(!A);let e=A?"Unrestricted mode disabled. My responses are now focused on Himalaya Public School.":"Unrestricted mode enabled. I can now answer general knowledge questions.";v(t=>[...t,{id:"user-".concat(Date.now()),text:a,sender:"user"},{id:"mode-switch-".concat(Date.now()),text:e,sender:"ai"}]),j("");return}let r={id:"user-".concat(Date.now()),text:a,sender:"user"};v(e=>[...e,r]),j(""),S(!0);try{let e=await (0,x.e)({question:a,unrestrictedMode:A,language:T}),r=e.answer,s=e.safetyBlocked;if(e.action&&("navigate"===e.action.type&&"string"==typeof e.action.payload?(E.push(e.action.payload),t(!1)):"set_theme"===e.action.type&&"string"==typeof e.action.payload&&M(e.action.payload)),s){let t=D+1;L(t);let a=6e4;t>1&&(a=Math.min((1+(t-1)*5)*6e4,864e5));let s=Date.now()+a;R(s),r=e.answer||"Your query was blocked due to content policy. Interaction is temporarily disabled.",v(e=>[...e,{id:"ai-".concat(Date.now()),text:r,sender:"ai",isCooldownMessage:!0}])}else r&&""!==r.trim()?v(e=>[...e,{id:"ai-".concat(Date.now()),text:r,sender:"ai"}]):e.action||v(e=>[...e,{id:"ai-empty-".concat(Date.now()),text:"The AI didn't provide a specific answer to this query. Please try rephrasing or ask something else.",sender:"ai",isError:!0}])}catch(e){console.error("Error calling AI assistant:",e),v(e=>[...e,{id:"error-".concat(Date.now()),text:"Sorry, I encountered an error. Please try again. If the problem persists, the AI model might be temporarily unavailable.",sender:"ai",isError:!0}])}finally{S(!1)}};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"fixed bottom-6 right-6 z-50 h-16 w-16 rounded-full p-1  bg-gradient-to-r from-purple-600 via-blue-900 to-orange-500 bg-[length:200%_200%] animate-gradient-slide flex items-center justify-center shadow-2xl",children:(0,r.jsxs)(d.cj,{open:e,onOpenChange:e=>{t(e)},children:[(0,r.jsx)(d.CG,{asChild:!0,children:(0,r.jsx)(o.$,{variant:"default",size:"icon",className:"relative h-14 w-14 rounded-full shadow-xl flex items-center justify-center overflow-hidden p-0","aria-label":"Open AI Helper",children:(0,r.jsx)("div",{className:"absolute inset-0 w-full h-full rounded-full bg-gradient-to-r from-pink-500 via-purple-600 through-cyan-400 to-green-400  bg-[length:250%_250%] animate-gradient-slide flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-2xl font-bold text-white tracking-tight",children:"AI"})})})}),(0,r.jsxs)(d.h,{side:"right",className:"w-full sm:max-w-md flex flex-col p-0",children:[(0,r.jsxs)(d.Fm,{className:"p-4 border-b",children:[(0,r.jsxs)(d.qp,{className:"flex items-center gap-2 text-primary",children:[A?(0,r.jsx)(m.A,{className:"h-6 w-6 text-orange-500"}):(0,r.jsx)(m.A,{className:"h-6 w-6"}),A?"General AI Assistant":"HPS AI Assistant"]}),(0,r.jsx)(d.Qs,{className:"text-xs",children:A?'You can ask me anything! To return to school-specific info, type "#10x10" again.':"Ask me anything about Himalaya Public School."})]}),(0,r.jsx)(i.F,{className:"flex-grow p-4",ref:C,children:(0,r.jsxs)("div",{className:"space-y-4",children:[a.map(e=>(0,r.jsxs)("div",{className:(0,p.cn)("flex items-end gap-2 text-sm","user"===e.sender?"justify-end":"justify-start"),children:["ai"===e.sender&&(0,r.jsx)(m.A,{className:(0,p.cn)("h-6 w-6 shrink-0 mb-1",A&&"ai"===e.sender?"text-orange-500":"text-primary")}),(0,r.jsx)("div",{className:(0,p.cn)("max-w-[80%] rounded-lg px-3 py-2 shadow","user"===e.sender?"bg-primary text-primary-foreground":e.isError?"bg-destructive text-destructive-foreground border border-destructive":e.isCooldownMessage?"bg-yellow-100 text-yellow-800 border border-yellow-300 dark:bg-yellow-900/30 dark:text-yellow-300 dark:border-yellow-700":"bg-card text-card-foreground border"),children:(0,r.jsx)("p",{className:"whitespace-pre-line",children:e.text})}),"user"===e.sender&&(0,r.jsx)(u.A,{className:"h-6 w-6 text-muted-foreground shrink-0 mb-1"})]},e.id)),N&&(0,r.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[(0,r.jsx)(m.A,{className:(0,p.cn)("h-6 w-6 shrink-0 mb-1",A?"text-orange-500":"text-primary")}),(0,r.jsx)("div",{className:"bg-card text-card-foreground border rounded-lg px-3 py-2 shadow",children:(0,r.jsx)(h.A,{className:"h-5 w-5 animate-spin text-primary"})})]}),z&&q&&!N&&(0,r.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[(0,r.jsx)(f.A,{className:(0,p.cn)("h-6 w-6 shrink-0 mb-1","text-yellow-500")}),(0,r.jsx)("div",{className:(0,p.cn)("max-w-[80%] rounded-lg px-3 py-2 shadow","bg-yellow-100 text-yellow-800 border border-yellow-300 dark:bg-yellow-900/30 dark:text-yellow-300 dark:border-yellow-700"),children:(0,r.jsxs)("p",{className:"whitespace-pre-line text-sm",children:["Interaction is temporarily disabled. Please wait: ",q]})})]})]})}),(0,r.jsx)(d.XW,{className:"p-4 border-t",children:(0,r.jsxs)("form",{onSubmit:Y,className:"flex w-full items-center space-x-2",children:[(0,r.jsx)(c.p,{type:"text",value:k,onChange:e=>j(e.target.value),placeholder:z?"Interaction is on cooldown...":A?"Ask me anything...":"Ask about the school...",className:"flex-1",disabled:N||z,"aria-label":"Your question for the AI assistant"}),(0,r.jsxs)(o.$,{type:"submit",size:"icon",disabled:N||!k.trim()||z,children:[N?(0,r.jsx)(h.A,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(y,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Send"})]})]})})]})]})})})}},19134:(e,t,a)=>{a.d(t,{e:()=>s});var r=a(34477);let s=(0,r.createServerReference)("401db5a6cd2799d23e68391e645e29759a1a93ef82",r.callServer,void 0,r.findSourceMapURL,"askSchoolAI")},35695:(e,t,a)=>{var r=a(18999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},38382:(e,t,a)=>{a.d(t,{CG:()=>d,Fm:()=>y,Qs:()=>g,XW:()=>x,cj:()=>i,h:()=>f,qp:()=>p});var r=a(95155),s=a(12115),n=a(15452),l=a(74466),o=a(25318),c=a(59434);let i=n.bL,d=n.l9;n.bm;let m=n.ZL,u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.hJ,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/80",a),...s,ref:t})});u.displayName=n.hJ.displayName;let h=(0,l.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b",bottom:"inset-x-0 bottom-0 border-t",left:"inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm"}},defaultVariants:{side:"right"}}),f=s.forwardRef((e,t)=>{let{side:a="right",className:s,children:l,...i}=e;return(0,r.jsxs)(m,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(n.UC,{ref:t,className:(0,c.cn)(h({side:a}),s),...i,children:[l,(0,r.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=n.UC.displayName;let y=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};y.displayName="SheetHeader";let x=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};x.displayName="SheetFooter";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.hE,{ref:t,className:(0,c.cn)("text-lg font-semibold text-foreground",a),...s})});p.displayName=n.hE.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.VY,{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",a),...s})});g.displayName=n.VY.displayName},51362:(e,t,a)=>{a.d(t,{D:()=>c,N:()=>i});var r=a(12115),s=["light","dark"],n="(prefers-color-scheme: dark)",l=r.createContext(void 0),o={setTheme:e=>{},themes:[]},c=()=>{var e;return null!=(e=r.useContext(l))?e:o},i=e=>r.useContext(l)?e.children:r.createElement(m,{...e}),d=["light","dark"],m=e=>{let{forcedTheme:t,disableTransitionOnChange:a=!1,enableSystem:o=!0,enableColorScheme:c=!0,storageKey:i="theme",themes:m=d,defaultTheme:x=o?"system":"light",attribute:p="data-theme",value:g,children:w,nonce:b}=e,[v,k]=r.useState(()=>h(i,x)),[j,N]=r.useState(()=>h(i)),S=g?Object.values(g):m,A=r.useCallback(e=>{let t=e;if(!t)return;"system"===e&&o&&(t=y());let r=g?g[t]:t,n=a?f():null,l=document.documentElement;if("class"===p?(l.classList.remove(...S),r&&l.classList.add(r)):r?l.setAttribute(p,r):l.removeAttribute(p),c){let e=s.includes(x)?x:null,a=s.includes(t)?t:e;l.style.colorScheme=a}null==n||n()},[]),I=r.useCallback(e=>{let t="function"==typeof e?e(e):e;k(t);try{localStorage.setItem(i,t)}catch(e){}},[t]),C=r.useCallback(e=>{N(y(e)),"system"===v&&o&&!t&&A("system")},[v,t]);r.useEffect(()=>{let e=window.matchMedia(n);return e.addListener(C),C(e),()=>e.removeListener(C)},[C]),r.useEffect(()=>{let e=e=>{e.key===i&&I(e.newValue||x)};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[I]),r.useEffect(()=>{A(null!=t?t:v)},[t,v]);let E=r.useMemo(()=>({theme:v,setTheme:I,forcedTheme:t,resolvedTheme:"system"===v?j:v,themes:o?[...m,"system"]:m,systemTheme:o?j:void 0}),[v,I,t,j,o,m]);return r.createElement(l.Provider,{value:E},r.createElement(u,{forcedTheme:t,disableTransitionOnChange:a,enableSystem:o,enableColorScheme:c,storageKey:i,themes:m,defaultTheme:x,attribute:p,value:g,children:w,attrs:S,nonce:b}),w)},u=r.memo(e=>{let{forcedTheme:t,storageKey:a,attribute:l,enableSystem:o,enableColorScheme:c,defaultTheme:i,value:d,attrs:m,nonce:u}=e,h="system"===i,f="class"===l?"var d=document.documentElement,c=d.classList;".concat("c.remove(".concat(m.map(e=>"'".concat(e,"'")).join(","),")"),";"):"var d=document.documentElement,n='".concat(l,"',s='setAttribute';"),y=c?(s.includes(i)?i:null)?"if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'".concat(i,"'"):"if(e==='light'||e==='dark')d.style.colorScheme=e":"",x=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=d?d[e]:e,n=t?e+"|| ''":"'".concat(r,"'"),o="";return c&&a&&!t&&s.includes(e)&&(o+="d.style.colorScheme = '".concat(e,"';")),"class"===l?t||r?o+="c.add(".concat(n,")"):o+="null":r&&(o+="d[s](n,".concat(n,")")),o},p=t?"!function(){".concat(f).concat(x(t),"}()"):o?"!function(){try{".concat(f,"var e=localStorage.getItem('").concat(a,"');if('system'===e||(!e&&").concat(h,")){var t='").concat(n,"',m=window.matchMedia(t);if(m.media!==t||m.matches){").concat(x("dark"),"}else{").concat(x("light"),"}}else if(e){").concat(d?"var x=".concat(JSON.stringify(d),";"):"").concat(x(d?"x[e]":"e",!0),"}").concat(h?"":"else{"+x(i,!1,!1)+"}").concat(y,"}catch(e){}}()"):"!function(){try{".concat(f,"var e=localStorage.getItem('").concat(a,"');if(e){").concat(d?"var x=".concat(JSON.stringify(d),";"):"").concat(x(d?"x[e]":"e",!0),"}else{").concat(x(i,!1,!1),";}").concat(y,"}catch(t){}}();");return r.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:p}})}),h=(e,t)=>{let a;try{a=localStorage.getItem(e)||void 0}catch(e){}return a||t},f=()=>{let e=document.createElement("style");return e.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(e),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(e)},1)}},y=e=>(e||(e=window.matchMedia(n)),e.matches?"dark":"light")},77724:(e,t,a)=>{a.d(t,{A:()=>r});let r=(0,a(40157).A)("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]])},84111:(e,t,a)=>{a.d(t,{A:()=>r});let r=(0,a(40157).A)("ShieldBan",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m4.243 5.21 14.39 12.472",key:"1c9a7c"}]])},91721:(e,t,a)=>{a.d(t,{A:()=>r});let r=(0,a(40157).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}}]);